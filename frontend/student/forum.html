{% extends "student/dashboard.html" %}
{% set active_page = 'forum' %}

{% block dashboard_content %}
<h4 class="fw-semibold mb-3">Forum</h4>

<!-- Add New Post -->
<form method="POST" action="{{ url_for('student.add_post') }}" class="mb-4">
  <div class="input-group">
    <input type="text" name="title" class="form-control" placeholder="Start a new discussion..." required>
    <button class="btn btn-success">Post</button>
  </div>
</form>

{% if posts %}
  {% for post in posts %}
  <div class="card mb-3 shadow-sm">
    <div class="card-body">
      <h5 class="card-title">
        <a href="{{ url_for('student.forum_post_detail', post_id=post.postID) }}">{{ post.title }}</a>
      </h5>
      <p class="card-text text-muted small">
        by {{ post.user.name if post.user else 'Anonymous' }} â€¢ {{ post.timestamp.strftime('%d %b %Y, %I:%M %p') }}
      </p>
      <a href="{{ url_for('student.forum_post_detail', post_id=post.postID) }}" class="btn btn-outline-primary btn-sm">
        View Comments ({{ post.comments|length }})
      </a>
    </div>
  </div>
  {% endfor %}
{% else %}
  <div class="alert alert-info">No posts yet. Start the conversation!</div>
{% endif %}
{% endblock %}
